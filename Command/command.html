<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Web Command Prompt</title>
  <style>
    body {
      background-color: black;
      color: lime;
      font-family: monospace;
      margin: 0;
      padding: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    #output {
      padding: 20px;
      padding-bottom: 60px; /* extra space so last lines aren't hidden */
      flex: 1; 
      overflow-y: auto;
      white-space: pre; /* preserve exact spacing for ASCII art */
    }

    #inputContainer {
      position: fixed;
      bottom: 0;
      width: 100%;
      background-color: black;
      padding: 10px;
    }

    input {
      width: 100%;
      padding: 10px;
      background-color: black;
      color: lime;
      border: none;
      outline: none;
      font-family: monospace;
    }
  </style>
</head>
<body>
  <div id="output">Welcome! Type a command below:</div>
  <div id="inputContainer">
    <input type="text" id="commandInput" placeholder="Type a command..." autofocus />
  </div>

  <script>
    const output = document.getElementById('output');
    const input = document.getElementById('commandInput');

    // Predefined users with passwords and access levels
    const users = {
      'frisk': { password: '1234', access: 'admin' },
      'temmie': { password: 'temlove', access: 'user' },
      'sans': { password: 'bones', access: 'moderator' }
    };

    // Logs by access level
    const logs = {
      user: ['User log: Activity started', 'User log: Task completed'],
      moderator: ['Moderator log: Review reports', 'Moderator log: Action taken'],
      admin: ['Admin log: Server restart', 'Admin log: User banned', 'Admin log: Full system report']
    };

    let loginState = null; // null | 'username' | 'password'
    let currentUser = '';
    let loggedInUser = null;

    input.addEventListener('keydown', function(event) {
      if (event.key === 'Enter') {
        const command = input.value.trim();
        input.value = '';

        output.innerText += `\n> ${command}`;

        if (!loginState && !loggedInUser) {
          if (command.toLowerCase() === 'login') {
            loginState = 'username';
            output.innerText += `
======================================================
 __        __   _ _                          
 \\ \\      / /__| | | ___ ___  _ __ ___   ___
  \\ \\ /\\ / / _ \\ | |/ __/ _ \\| '_ \` _ \\ / _ \\
   \\ V  V /  __/ | | (_| (_) | | | | | |  __/
    \\_/\\_/ \\___|_|_|\\___\\___/|_| |_| |_|\\___/
======================================================
Enter Username:`;
          } else {
            output.innerText += `\nYou must login first to use commands.`;
          }
        } else if (loginState === 'username') {
          currentUser = command;
          if (users[currentUser]) {
            loginState = 'password';
            output.innerText += `\nEnter Password:`;
          } else {
            output.innerText += `\nUsername not found. Try again.`;
          }
        } else if (loginState === 'password') {
          if (users[currentUser].password === command) {
            output.innerText += `\nLogin successful! Welcome, ${currentUser}.`;
            loggedInUser = currentUser;
          } else {
            output.innerText += `\nIncorrect password. Login failed.`;
          }
          loginState = null;
          currentUser = '';
        } else if (loggedInUser) {
          const accessLevel = users[loggedInUser].access;

          if (command.toLowerCase() === 'logs') {
            let allowedLogs = [];
            if (accessLevel === 'user') allowedLogs = logs.user;
            if (accessLevel === 'moderator') allowedLogs = logs.user.concat(logs.moderator);
            if (accessLevel === 'admin') allowedLogs = logs.user.concat(logs.moderator, logs.admin);

            output.innerText += '\n' + allowedLogs.join('\n');
          } else if (command.toLowerCase() === 'userlist') {
            if (accessLevel === 'admin') {
              const userList = Object.entries(users)
                .map(([name, info]) => `${name} - ${info.access}`)
                .join('\n');
              output.innerText += '\n' + userList;
            } else {
              output.innerText += '\nCommand not recognized.';
            }
          } else if (command === 'j$vF>7%') {
            if (accessLevel === 'admin') {
              window.location.replace("../glitch/glitch.html");
            }
          } else if (command.toLowerCase() === 'logout') {
            output.innerText += `\nUser ${loggedInUser} logged out. All commands are now restricted.`;
            loggedInUser = null;
          } else {
            output.innerText += '\nCommand not recognized.';
          }
        }

        output.scrollTop = output.scrollHeight;
      }
    });
  </script>
</body>
</html>
